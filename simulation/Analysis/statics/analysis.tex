\documentclass[11pt]{article}

% --- Encoding & Language ---
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}

% --- Math Packages ---
\usepackage{amsmath, amssymb, amsfonts}
\usepackage{mathtools}
\usepackage{physics}          % for \dv, \pdv, \grad, etc.
\usepackage{bm}               % for bold math symbols
\usepackage{siunitx}          % for units

% --- Page Layout ---
\usepackage[margin=1in]{geometry}
\usepackage{setspace}
\onehalfspacing

% --- Theorem Environment ---
\usepackage{amsthm}
% Create a shared counter (let's call it 'statement') per section
\newtheorem{statement}{Statement}[section]
\newtheorem{theorem}[statement]{Theorem}
 
% Define 'assumption' and 'diagram' to use the same counter
\newtheorem{assumption}[statement]{Assumption}
\newtheorem{diagram}[statement]{Diagram}
\newtheorem{note}[statement]{Note}

% --- Figure & Table ---
\usepackage{graphicx}
\usepackage{float}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{mwe}
% \includegraphics{example-image}


% --- TikZ for Diagrams ---
\usepackage{tikz}
\usetikzlibrary{arrows.meta, decorations.pathmorphing, patterns}

% --- Code Listings (optional) ---
\usepackage{listings}
\lstset{
  basicstyle=\ttfamily\small,
  frame=single,
  breaklines=true,
  postbreak=\mbox{\textcolor{red}{$\hookrightarrow$}\space},
}


% --- Title Info ---
\title{\textbf{Force Based Model Analysis}}
\author{Jerry Wu}
\date{\today}

\begin{document}

\maketitle

\begin{assumption}\label{ass:leg-ground-contact}
The end point of each leg is always contacting the ground.
\end{assumption}

\begin{assumption}\label{ass: no-body-contact}
The robot body would never contact with the terrain
\end{assumption}

\section{Statics}
\begin{assumption}
Static means the robot would not move and achieve static equilibrium in this state
\end{assumption}
\subsection*{Slope}

\begin{diagram}
    Simple case where two legs have same height
\end{diagram}\label{ass:h2-equal-h1}
\vspace{1ex} % small vertical space
\begin{center}
    \includegraphics[width=0.6\textwidth]{example-image} % replace with your image
\end{center}

To start with,  we put robot on a slope with angle \(\theta\). To make the analysis easier,
assume that two leg have same height \(h\) in this case. Therefore, the moment arm are symetric
for \(R_A\) and \(R_B\). Therefore, we can get follow equations:
\[ \sum F_x = (f_1+f_2) - \sin(\theta)mg = 0 \]
\[ \sum F_y = (N_A+N_B) - \cos(\theta)mg = 0 \]
\[ \sum M_A = L_\text{spine} \cdot N_B -  L \cdot mg \cdot \sin(\frac{\pi}{2}-\phi+\theta) = 0 \]
\[ \sum M_B = L_\text{spine} \cdot N_A -  L \cdot mg \cdot \sin(\frac{\pi}{2}-\phi+\theta) = 0 \]

\begin{diagram}
    Two legs have different height
\end{diagram}\label{ass:h2-larger-than-h1}
\vspace{1ex} % small vertical space
\begin{center}
    \includegraphics[width=0.5\textwidth]{example-image} % replace with your image
\end{center}

Now extend the case to where the leg length would change. Here the robot extended
the right leg to \(h_2\), which makes the robot rotate angle \(\beta\) around
the z-Axis. Now both moment arms on two legs are 
shifted. We can also form the static equilibrium equation as follows:

\[ \sum F_x = (f_1+f_2) - \sin(\theta)mg = 0 \]
\[ \sum F_y = (N_A+N_B) - \cos(\theta)mg = 0 \]
\[ \sum M_A = \frac{L_\text{spine}}{\sin(\frac{\pi}{2}-\beta)} \cdot N_B \cdot \sin(\frac{\pi}{2})-  L_1 \cdot mg \cdot \sin(\frac{\pi}{2}-\phi_1+\theta) = 0 \]
\[ \sum M_B = \frac{L_\text{spine}}{\sin(\frac{\pi}{2}-\beta)} \cdot N_A \cdot \sin(\frac{\pi}{2})-  L_2 \cdot mg \cdot \sin(\frac{\pi}{2}-\phi_2-\theta) = 0 \]

based on the geometry of our robot, we can also formulate:
\[L_\text{spine} \cdot \cos(\frac{\pi}{2}-\beta) = h_2 - h_1 \]

\begin{note}\label{not:what-is-known}
\(h_1\), \(h_2\) are known values, so \(\beta\) is also known.  
Therefore, \(\phi_1\) and \(\phi_2\) can easily be solved using Theorem~\ref{thm:law-of-cosines}.
\end{note}

\begin{theorem}\label{thm:law-of-cosines}
Law of Cosines

\[
\cos A = \frac{b^2 + c^2 - a^2}{2bc}
\]
\[
\cos B = \frac{a^2 + c^2 - b^2}{2ac}
\]
\[
\cos C = \frac{a^2 + b^2 - c^2}{2ab}
\]
\end{theorem}


\subsection*{Triangle Obstable Terrain}

\begin{assumption}\label{ass:triangle-terrain-assumption}
The terrain is uniform that all triangle obstable and gap between them are same
\end{assumption}

A natural extension for the slope is triangle terrain. There are esseintially five cases
when robot is static on the triangle terrain: 1. two legs on the same slope 2. two legs on two slopes that face each other
3. two legs on two slopes that does not face each other 4. one leg is on the slope and the other is on the gap. 5. two legs
are all on the gap. 

For case 1, we have already discussed in the previous section. And for case 5, it is esseintially the same
like slope when \(\theta\) is 0.

\begin{diagram}
    Case2: two legs on the slope that face each other
\end{diagram}
\vspace{1ex} % small vertical space
\begin{center}
    \includegraphics[width=0.5\textwidth]{example-image} % replace with your image
\end{center}

To make it clearer, I changed the coordinate that aligns with the ground rather slope from now on.
We can also formulate the equilibrium equations:

\[ \sum F_x = (-f_1+f_2)\cos(\theta) + (N_A-N_B) \sin(\theta) = 0 \]
\[ \sum F_y = (f_1+f_2)\sin(\theta) + (N_A+N_B) \cos(\theta) - mg = 0 \]
\[ \sum M_A =  L_\text{Arm} \cdot (N_B \cdot \sin(\frac{\pi}{2}-\omega_2) + f_2 \cdot \sin(\pi-\omega_2)) - L_1\cdot mg \cdot \sin(\mu_1)= 0 \]
\[ \sum M_B =  L_\text{Arm} \cdot (N_B \cdot \sin(\frac{\pi}{2}-\omega_1) + f_1 \cdot \sin(\pi-\omega_1)) - L_2\cdot mg \cdot \sin(\mu_2)= 0 \]

where by geometry of the shape, we can find:
\[\omega_1 = (\theta + \beta)  - (\frac{\pi}{2}-\alpha) \]
\[\omega_2 = (\theta - \beta) + (\frac{\pi}{2}-\alpha) \]
\[\mu_1 = \pi-(\phi_1+\omega_1)-(\frac{\pi}{2}-\theta) \]
\[\mu_2 = \pi-(\phi_2+\omega_2)-(\frac{\pi}{2}-\theta) \]
\[\alpha = \arctan(\frac{L_\text{Spine}}{h2-h1}) \]
\[L_\text{Arm} = \sin(\alpha) \cdot L_\text{Spine}\]

similarly to Note~\ref{not:what-is-known}, this equalion can be solved.

\begin{diagram}
    Case3: two legs on two slopes that do not face each other
\end{diagram}
\vspace{1ex} % small vertical space
\begin{center}
    \includegraphics[width=0.5\textwidth]{example-image} % replace with your image
\end{center}

\[ \sum F_x = (f_1-f_2)\cos(\theta) + (-N_A+N_B) \sin(\theta) = 0 \]
\[ \sum F_y = (f_1-f_2)\sin(\theta) + (-N_A+N_B) \cos(\theta) - mg = 0 \]
\[ \sum M_A =  L_\text{Arm} \cdot (N_B \cdot \sin(\pi-\omega_2) + f_2 \cdot \sin(\frac{\pi}{2}-\omega_2)) - L_1\cdot mg \cdot \sin(\mu_1)= 0 \]
\[ \sum M_B =  L_\text{Arm} \cdot (N_A \cdot \sin(\pi-\omega_1) + f_1 \cdot \sin(\frac{\pi}{2}-\omega_1)) - L_2\cdot mg \cdot \sin(\mu_2)= 0 \]

where by geometry of the shape, we can find:
\[\omega_1 = \beta + \alpha - \theta\]
\[\omega_2 =  \pi - \beta - \alpha - \theta\]
\[\mu_1 = \pi-(\phi_1+\omega_1)-\theta \]
\[\mu_2 = \pi-(\phi_2+\omega_2)-\theta \]
\[\alpha = \arctan(\frac{L_\text{Spine}}{h2-h1}) \]
\[L_\text{Arm} = \sin(\alpha) \cdot L_\text{Spine}\]

\begin{note}
The equation for \(\omega_1\)  can be found specifically by following equation:
\end{note}
\begin{equation}
x_1 + \phi_1 + \omega_1 + \theta = \pi
\end{equation}

\begin{equation}
\beta + x_1 + \phi_1 - \left( \frac{\pi}{2} - \alpha \right) = \frac{\pi}{2}
\end{equation}

\begin{equation}
\omega_1 = \beta + \alpha - \theta
\tag*{From (1) and (2)}
\end{equation}

\begin{diagram}
    Case4: one leg is on the slope and the other is on the gap
\end{diagram}
\vspace{1ex} % small vertical space
\begin{center}
    \includegraphics[width=0.5\textwidth]{example-image} % replace with your image
\end{center}

\[ \sum F_x = -f_1 \cos(\theta) -f_2 + N_A \sin(\theta)= 0 \]
\[ \sum F_y = f_1 \sin(\theta)+ N_A \cos(\theta) + N_B - mg = 0 \]
\[ \sum M_A =  L_\text{Arm} \cdot (N_B \cdot \sin(\pi-\omega_2) + f_2 \cdot \sin(\frac{\pi}{2}-\omega_2)) - L_1\cdot mg \cdot \sin(\mu_1)= 0 \]
\[ \sum M_B =  L_\text{Arm} \cdot (N_B \cdot \sin(\pi-\omega_1) + f_1 \cdot \sin(\frac{3\pi}{2}-\omega_1)) - L_2\cdot mg \cdot \sin(\mu_2)= 0 \]

where by geometry of the shape, we can find:
\[\omega_1 = \theta - \beta + \alpha\]
\[\omega_2 =  \pi + \beta - \alpha \]
\[\mu_1 = \pi-(\phi_1+\omega_1)-\theta \]
\[\mu_2 = \pi-(\phi_2+\omega_2) \]
\[\alpha = \arctan(\frac{L_\text{Spine}}{h2-h1}) \]
\[L_\text{Arm} = \sin(\alpha) \cdot L_\text{Spine}\]

\begin{note}
The equation for \(\omega_1\)  can be found specifically by following equation:
\end{note}
\begin{equation}
x_1 + \phi_1 + \omega_1 = \pi
\end{equation}

\begin{equation}
\theta-\beta + x_1 + \phi_1 - \left( \frac{\pi}{2} - \alpha \right) = \frac{\pi}{2}
\end{equation}

\begin{equation}
\omega_1 = \theta - \beta + \alpha
\tag*{From (1) and (2)}
\end{equation}

Now, by observation, this case is very similar to previous case. In fact, all of the above cases
are geometrically similar, which means we can find a general expression for this force based model.

\subsection*{Generalizaed Expression}
\begin{diagram}
    Generailized Free Body Diagram
\end{diagram}
\vspace{1ex} % small vertical space
\begin{center}
    \includegraphics[width=0.5\textwidth]{example-image} % replace with your image
\end{center}

\begin{diagram}
    Generailized Free Body Diagram
\end{diagram}
\vspace{1ex} % small vertical space
\begin{center}
    \includegraphics[width=0.5\textwidth]{example-image} % replace with your image
\end{center}
Given \((X_A, Y_A), (X_B, Y_B), (X_{COM}, Y_{COM}), \theta_1, \theta_2\), \(L_{Spine}\) we can form
\[
\sum \vec{F} = \vec{f}_1 + \vec{f}_2 + \vec{N}_A + \vec{N}_B + \vec{W} = \vec{0}
\]

\[
\sum \vec{M}_A = 
(\vec{r}_B - \vec{r}_A) \times (\vec{f}_2 + \vec{N}_B)
+ (\vec{r}_{\text{COM}} - \vec{r}_A) \times \vec{W}
= 0
\]

\[
\sum \vec{M}_B = 
(\vec{r}_A - \vec{r}_B) \times (\vec{f}_1 + \vec{N}_A)
+ (\vec{r}_{\text{COM}} - \vec{r}_B) \times \vec{W}
= 0
\]

where
\begin{align*}
\hat{t}_1 &= (\cos\theta_1,\; \sin\theta_1) \quad \text{(contact tangent 1)} \\
\hat{n}_1 &= (-\sin\theta_1,\; \cos\theta_1) \quad \text{(contact normal 1)} \\
\hat{t}_2 &= (\cos\theta_2,\; \sin\theta_2) \\
\hat{n}_2 &= (-\sin\theta_2,\; \cos\theta_2)
\end{align*}

\begin{align*}
\vec{f}_1 &= f_1 \cdot \hat{t}_1 = f_1 (\cos\theta_1,\; \sin\theta_1) \\
\vec{N}_A &= N_A \cdot \hat{n}_1 = N_A (-\sin\theta_1,\; \cos\theta_1) \\
\vec{f}_2 &= f_2 \cdot \hat{t}_2 = f_2 (\cos\theta_2,\; \sin\theta_2) \\
\vec{N}_B &= N_B \cdot \hat{n}_2 = N_B (-\sin\theta_2,\; \cos\theta_2) \\
\vec{W}   &= -mg \cdot (0,\; 1)
\end{align*}


\begin{align*}
\text{Moment arm of } \vec{f}_2, \vec{N}_B \text{ about A}: \quad
& \vec{r}_{f_2/A} = \vec{r}_B - \vec{r}_A = (X_B - X_A,\; Y_B - Y_A) \\
\text{Moment arm of } \vec{W} \text{ about A}: \quad
& \vec{r}_{W/A} = \vec{r}_{\text{COM}} - \vec{r}_A = (X_{COM} - X_A,\; Y_{COM} - Y_A) \\[1ex]
\text{Moment arm of } \vec{f}_1, \vec{N}_A \text{ about B}: \quad
& \vec{r}_{f_1/B} = \vec{r}_A - \vec{r}_B = (X_A - X_B,\; Y_A - Y_B) \\
\text{Moment arm of } \vec{W} \text{ about B}: \quad
& \vec{r}_{W/B} = \vec{r}_{\text{COM}} - \vec{r}_B = (X_{COM} - X_B,\; Y_{COM} - Y_B)
\end{align*}

Therefore,
\begin{align*}
\sum \vec{F}_x &= f_1 \cos\theta_1 + f_2 \cos\theta_2 - N_A \sin\theta_1 - N_B \sin\theta_2 = 0 \\
\sum \vec{F}_y &= f_1 \sin\theta_1 + f_2 \sin\theta_2 + N_A \cos\theta_1 + N_B \cos\theta_2 - mg = 0\\
\sum \vec{M}_A &= (X_B - X_A)(f_2 \sin\theta_2 + N_B \cos\theta_2)
- (Y_B - Y_A)(f_2 \cos\theta_2 - N_B \sin\theta_2)
- mg (X_{COM} - X_A) = 0 \\
\sum \vec{M}_B &= (X_A - X_B)(f_1 \sin\theta_1 + N_A \cos\theta_1)
- (Y_A - Y_B)(f_1 \cos\theta_1 - N_A \sin\theta_1)
- mg (X_{COM} - X_B) = 0
\end{align*}





\end{document}
